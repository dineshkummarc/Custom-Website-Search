<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd"><html dir="LTR" xmlns:ndoc="urn:ndoc-schema"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta content="history" name="save" /><meta name="vs_targetSchema" content="http://schemas.microsoft.com/intellisense/ie5" /><title>Similarity Class</title><xml></xml><link rel="stylesheet" type="text/css" href="MSDN.css" /></head><body id="bodyID" class="dtBODY"><script type="text/javascript">
    	window.onload = function() {
	    	var i = window.frames["iframe_navi"];
	    	i.syncTree(document.URL);
    	}
    </script><div id="navi"><iframe src="contents.html" id="iframe_navi" name="iframe_navi"></iframe></div><div id="nsbanner"><div id="bannerrow1"><table class="bannerparthead" cellspacing="0"><tr id="hdr"><td class="runninghead">Lucene.Net</td><td class="product"></td></tr></table></div><div id="TitleRow"><h1 class="dtH1">Similarity Class</h1></div></div><div id="nstext">Expert: Scoring API. <p xmlns="urn:ndoc-schema"></p>Subclasses implement search scoring. <p xmlns="urn:ndoc-schema"></p>The score of query <code>q</code> for document <code>d</code> correlates to the cosine-distance or dot-product between document and query vectors in a <a href="http://en.wikipedia.org/wiki/Vector_Space_Model" xmlns="urn:ndoc-schema"> Vector Space Model (VSM) of Information Retrieval</a>. A document whose vector is closer to the query vector in that model is scored higher. The score is computed as follows: <p xmlns="urn:ndoc-schema"></p><table cellpadding="1" cellspacing="0" border="1" align="center" xmlns="urn:ndoc-schema"><tr><td><table cellpadding="1" cellspacing="0" border="0" align="center"><tr><td valign="middle" align="right" rowspan="1"> score(q,d)   =   <A HREF="#formula_coord">coord(q,d)</A>  ·  <A HREF="#formula_queryNorm">queryNorm(q)</A>  ·  </td><td valign="bottom" align="center" rowspan="1"><big><big><big>∑</big></big></big></td><td valign="middle" align="right" rowspan="1"><big><big>(</big></big><A HREF="#formula_tf">tf(t in d)</A>  ·  <A HREF="#formula_idf">idf(t)</A><sup>2</sup>  ·  <A HREF="#formula_termBoost">t.Boost</A> ·  <A HREF="#formula_norm">norm(t,d)</A><big><big>)</big></big></td></tr><tr valigh="top"><td></td><td align="center"><small>t in q</small></td><td></td></tr></table></td></tr></table><p xmlns="urn:ndoc-schema"></p> where <ul type="disc"><li><A NAME="formula_tf" xmlns="urn:ndoc-schema"></A><b xmlns="urn:ndoc-schema">tf(t in d)</b> correlates to the term's <i xmlns="urn:ndoc-schema">frequency</i>, defined as the number of times term <i xmlns="urn:ndoc-schema">t</i> appears in the currently scored document <i xmlns="urn:ndoc-schema">d</i>. Documents that have more occurrences of a given term receive a higher score. The default computation for <i xmlns="urn:ndoc-schema">tf(t in d)</i> in <a href="Lucene.Net.Search.DefaultSimilarity.Tf1.html">DefaultSimilarity</a> is: <br /> <br /><table cellpadding="2" cellspacing="2" border="0" align="center" xmlns="urn:ndoc-schema"><tr><td valign="middle" align="right" rowspan="1"><b xmlns="">tf(t in d)</b>   =   </td><td valign="top" align="center" rowspan="1"> frequency<sup><big>½</big></sup></td></tr></table><br /> <br /></li><li><A NAME="formula_idf" xmlns="urn:ndoc-schema"></A><b xmlns="urn:ndoc-schema">idf(t)</b> stands for Inverse Document Frequency. This value correlates to the inverse of <i xmlns="urn:ndoc-schema">docFreq</i> (the number of documents in which the term <i xmlns="urn:ndoc-schema">t</i> appears). This means rarer terms give higher contribution to the total score. The default computation for <i xmlns="urn:ndoc-schema">idf(t)</i> in <a href="Lucene.Net.Search.DefaultSimilarity.Idf.html">DefaultSimilarity</a> is: <br /> <br /><table cellpadding="2" cellspacing="2" border="0" align="center" xmlns="urn:ndoc-schema"><tr><td valign="middle" align="right"><b xmlns="">idf(t)</b>  =   </td><td valign="middle" align="center"> 1 + log <big>(</big></td><td valign="middle" align="center"><table><tr><td align="center"><small>numDocs</small></td></tr><tr><td align="center">–––––––––</td></tr><tr><td align="center"><small>docFreq+1</small></td></tr></table></td><td valign="middle" align="center"><big>)</big></td></tr></table><br /> <br /></li><li><A NAME="formula_coord" xmlns="urn:ndoc-schema"></A><b xmlns="urn:ndoc-schema">coord(q,d)</b> is a score factor based on how many of the query terms are found in the specified document. Typically, a document that contains more of the query's terms will receive a higher score than another document with fewer query terms. This is a search time factor computed in <a href="Lucene.Net.Search.Similarity.Coord.html">coord(q,d)</a> by the Similarity in effect at search time. <br /> <br /></li><li><b xmlns="urn:ndoc-schema"><A NAME="formula_queryNorm"></A> queryNorm(q) </b> is a normalizing factor used to make scores between queries comparable. This factor does not affect document ranking (since all ranked documents are multiplied by the same factor), but rather just attempts to make scores from different queries (or even different indexes) comparable. This is a search time factor computed by the Similarity in effect at search time. The default computation in <a href="Lucene.Net.Search.DefaultSimilarity.QueryNorm.html">DefaultSimilarity</a> is: <br /> <br /><table cellpadding="1" cellspacing="0" border="0" align="center" xmlns="urn:ndoc-schema"><tr><td valign="middle" align="right" rowspan="1"> queryNorm(q)   =   <b xmlns="">queryNorm(sumOfSquaredWeights)</b>   =   </td><td valign="middle" align="center" rowspan="1"><table><tr><td align="center"><big>1</big></td></tr><tr><td align="center"><big> –––––––––––––– </big></td></tr><tr><td align="center">sumOfSquaredWeights<sup><big>½</big></sup></td></tr></table></td></tr></table><br /> <br /> The sum of squared weights (of the query terms) is computed by the query <a href="Lucene.Net.Search.Weight.html">Weight</a> object. For example, a <a href="Lucene.Net.Search.BooleanQuery.html">boolean query</a> computes this value as: <br /> <br /><table cellpadding="1" cellspacing="0" border="0" align="center" xmlns="urn:ndoc-schema"><tr><td valign="middle" align="right" rowspan="1"><a href="Lucene.Net.Search.Weight.GetSumOfSquaredWeights.html" xmlns="">GetSumOfSquaredWeights</a>   =   <a href="Lucene.Net.Search.Query.Boost.html" xmlns="">q.Boost</a><sup><big>2</big></sup>  ·  </td><td valign="bottom" align="center" rowspan="1"><big><big><big>∑</big></big></big></td><td valign="middle" align="right" rowspan="1"><big><big>(</big></big><A HREF="#formula_idf">idf(t)</A>  ·  <A HREF="#formula_termBoost">t.Boost</A><big><big>) <sup>2</sup></big></big></td></tr><tr valigh="top"><td></td><td align="center"><small>t in q</small></td><td></td></tr></table><br /> <br /></li><li><A NAME="formula_termBoost" xmlns="urn:ndoc-schema"></A><b xmlns="urn:ndoc-schema">t.Boost</b> is a search time boost of term <i xmlns="urn:ndoc-schema">t</i> in the query <i xmlns="urn:ndoc-schema">q</i> as specified in the query text (see <A HREF="../../../../../../queryparsersyntax.html#Boosting a Term" xmlns="urn:ndoc-schema">query syntax</A>), or as set by application calls to <b>Boost</b>. Notice that there is really no direct API for accessing a boost of one term in a multi term query, but rather multi terms are represented in a query as multi <a href="Lucene.Net.Search.TermQuery.html">TermQuery</a> objects, and so the boost of a term in the query is accessible by calling the sub-query <b>Boost</b>. <br /> <br /></li><li><A NAME="formula_norm" xmlns="urn:ndoc-schema"></A><b xmlns="urn:ndoc-schema">norm(t,d)</b> encapsulates a few (indexing time) boost and length factors: <ul type="disc"><li><b xmlns="urn:ndoc-schema">Document boost</b> - set by calling <a href="Lucene.Net.Documents.Document.Boost.html">doc.Boost</a> before adding the document to the index. </li><li><b xmlns="urn:ndoc-schema">Field boost</b> - set by calling <a href="Lucene.Net.Documents.IFieldable.Boost.html">field.Boost</a> before adding the field to a document. </li><li><a href="Lucene.Net.Search.Similarity.LengthNorm.html">LengthNorm(field)</a> - computed when the document is added to the index in accordance with the number of tokens of this field in the document, so that shorter fields contribute more to the score. LengthNorm is computed by the Similarity class in effect at indexing. </li></ul><p xmlns="urn:ndoc-schema"></p> When a document is added to the index, all the above factors are multiplied. If the document has multiple fields with the same name, all their boosts are multiplied together: <br /> <br /><table cellpadding="1" cellspacing="0" border="0" align="center" xmlns="urn:ndoc-schema"><tr><td valign="middle" align="right" rowspan="1"> norm(t,d)   =   <b xmlns="">doc.Boost</b>  ·  <b xmlns="">LengthNorm(field)</b>  ·  </td><td valign="bottom" align="center" rowspan="1"><big><big><big>∏</big></big></big></td><td valign="middle" align="right" rowspan="1"><b xmlns="">field.Boost</b></td></tr><tr valigh="top"><td></td><td align="center"><small>field <i><b>f</b></i> in <i>d</i> named as <i><b>t</b></i></small></td><td></td></tr></table><br /> <br /> However the resulted <i xmlns="urn:ndoc-schema">norm</i> value is <a href="Lucene.Net.Search.Similarity.EncodeNorm.html">encoded</a> as a single byte before being stored. At search time, the norm byte value is read from the index <a href="Lucene.Net.Store.Directory.html">directory</a> and <a href="Lucene.Net.Search.Similarity.DecodeNorm.html">decoded</a> back to a float <i xmlns="urn:ndoc-schema">norm</i> value. This encoding/decoding, while reducing index size, comes with the price of precision loss - it is not guaranteed that decode(encode(x)) = x. For instance, decode(encode(0.89)) = 0.75. Also notice that search time is too late to modify this <i xmlns="urn:ndoc-schema">norm</i> part of scoring, e.g. by using a different <b>Similarity</b> for search. <br /> <br /></li></ul><p>
                For a list of all members of this type, see <a href="Lucene.Net.Search.Similarity~Members.html">Similarity Members
                </a>.
              </p><p><a href="http://msdn.microsoft.com/en-us/library/System.Object(VS.100).aspx">System.Object</a><br />   <b>Similarity</b><br />      <a href="Lucene.Net.Search.DefaultSimilarity.html">DefaultSimilarity</a><br />      <a href="Lucene.Net.Search.SimilarityDelegator.html">SimilarityDelegator</a></p><div class="syntax"><div class="attribute">[Serializable]</div><div>public abstract class Similarity</div></div><H4 class="dtH4">Thread Safety</H4><P>
					Public static (<b>Shared</b> in Visual Basic) members of this type are
					safe for multithreaded operations. Instance members are <b>not</b> guaranteed to be
					thread-safe.
				</P><h4 class="dtH4">Requirements</h4><p><b>Namespace: </b><a href="Lucene.Net.Search.html">Lucene.Net.Search</a></p><p><b>Assembly: </b>Lucene.Net (in Lucene.Net.dll)
          </p><h4 class="dtH4">See Also</h4><p><a href="Lucene.Net.Search.Similarity~Members.html">Similarity Members</a> | <a href="Lucene.Net.Search.html">Lucene.Net.Search Namespace</a> | <a href="Lucene.Net.Search.Similarity.Default.html">Default</a> | <a href="Lucene.Net.Index.IndexWriter.Similarity.html">Similarity</a> | <a href="Lucene.Net.Search.Searcher.Similarity.html">Similarity</a></p><hr /><div id="footer"><p></p><p>Version: 3.0.3.0</p></div></div></body></html>